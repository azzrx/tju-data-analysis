# æ¨¡å‹åˆ‡æ¢ä¸æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½å®ç°è¯¦è§£

## ä¸€ã€æ¦‚è¿°

æœ¬æ–‡æ¡£è¯¦ç»†ä»‹ç»äº†ç³»ç»Ÿä¸­**æ¨¡å‹åˆ‡æ¢**å’Œ**æ–‡ä»¶ä¸Šä¼ **ä¸¤ä¸ªæ ¸å¿ƒåŠŸèƒ½çš„å®ç°ï¼ŒåŒ…æ‹¬å‰åç«¯ä»£ç çš„è¯¦ç»†è§£é‡Šå’Œå®Œæ•´çš„æµç¨‹å›¾ã€‚

### 1.1 åŠŸèƒ½æ¦‚è§ˆ

#### æ¨¡å‹åˆ‡æ¢åŠŸèƒ½
- **åŠŸèƒ½**ï¼šå…è®¸ç”¨æˆ·åœ¨ä¸åŒçš„å¤§è¯­è¨€æ¨¡å‹é…ç½®ä¹‹é—´åˆ‡æ¢
- **æ”¯æŒ**ï¼šDeepSeek APIã€æœ¬åœ° Ollama æ¨¡å‹ç­‰å¤šç§é…ç½®
- **ç‰¹ç‚¹**ï¼šåˆ‡æ¢åè‡ªåŠ¨é‡ç½®æ—¥å¿—ç³»ç»Ÿï¼Œç¡®ä¿æ–°æ¨¡å‹é…ç½®ç”Ÿæ•ˆ

#### æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½
- **åŠŸèƒ½**ï¼šå…è®¸ç”¨æˆ·ä¸Šä¼ æ–‡ä»¶ï¼Œå¹¶åœ¨èŠå¤©ä¸­å¼•ç”¨æ–‡ä»¶å†…å®¹
- **æ”¯æŒæ ¼å¼**ï¼šæ–‡æœ¬æ–‡ä»¶ï¼ˆ.txt, .md, .json, .jsonl, .csvï¼‰ã€Wordæ–‡æ¡£ï¼ˆ.docxï¼‰
- **ç‰¹ç‚¹**ï¼šæ–‡ä»¶å†…å®¹è‡ªåŠ¨è§£æå¹¶é™„åŠ åˆ°ç”¨æˆ·è¾“å…¥ï¼Œä¾›RAGå’ŒLLMä½¿ç”¨

---

## äºŒã€æ¨¡å‹åˆ‡æ¢åŠŸèƒ½

### 2.1 ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      å‰ç«¯ (Vue.js)                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Settings.vue â”‚  â”‚ ChatInput.vueâ”‚  â”‚   store.js   â”‚    â”‚
â”‚  â”‚  è®¾ç½®ç•Œé¢    â”‚  â”‚  è¾“å…¥ç»„ä»¶    â”‚  â”‚  çŠ¶æ€ç®¡ç†    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚         â”‚                  â”‚                  â”‚            â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                            â”‚                               â”‚
â”‚                            â–¼                               â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚                    â”‚   api.js     â”‚                       â”‚
â”‚                    â”‚  APIè°ƒç”¨å±‚   â”‚                       â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚ HTTP POST /api/models/switch
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      åç«¯ (Django)                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚   api.py     â”‚  â”‚model_config.pyâ”‚  â”‚ services.py  â”‚    â”‚
â”‚  â”‚  APIæ¥å£     â”‚  â”‚  é…ç½®ç®¡ç†     â”‚  â”‚ æœåŠ¡å±‚       â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚         â”‚                  â”‚                  â”‚            â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                            â”‚                               â”‚
â”‚                            â–¼                               â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚              â”‚   TopKLogSystem å®ä¾‹      â”‚                â”‚
â”‚              â”‚    (é‡ç½®ä»¥åº”ç”¨æ–°é…ç½®)      â”‚                â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 åç«¯å®ç°

#### 2.2.1 æ¨¡å‹é…ç½®ç®¡ç†ï¼ˆ`model_config.py`ï¼‰

**æ ¸å¿ƒåŠŸèƒ½**ï¼šç®¡ç†å¯ç”¨çš„æ¨¡å‹é…ç½®ï¼Œæä¾›é…ç½®åˆ‡æ¢åŠŸèƒ½

```python
# å¯ç”¨æ¨¡å‹é…ç½®å­—å…¸
AVAILABLE_CONFIGS = {
    "deepseek_api": {
        "name": "DeepSeek API",
        "description": "äº‘ç«¯æ¨ç†ï¼Œå…éƒ¨ç½²ï¼Œé€‚åˆéœ€è¦é«˜å¯é æ€§çš„åœºæ™¯",
        "config": {
            "llm": "deepseek-chat",
            "embedding_model": "nomic-embed-text",
            "llm_timeout": 60.0,
            "embedding_timeout": 180.0,
            "context_window": 32768,
            "use_api": True,  # ä½¿ç”¨APIæ¨¡å¼
        },
    },
    "fast_local": {
        "name": "Qwen 3B (æœ¬åœ°å¿«é€Ÿ)",
        "description": "Qwen2.5 3Bï¼Œæœ¬åœ°éƒ¨ç½²ï¼Œé€Ÿåº¦å¿«ï¼Œé€‚åˆå¼€å‘è°ƒè¯•",
        "config": {
            "llm": "qwen2.5:3b",
            "embedding_model": "nomic-embed-text",
            "llm_timeout": 300.0,
            "embedding_timeout": 180.0,
            "context_window": 4096,
            "use_api": False,  # ä½¿ç”¨æœ¬åœ°Ollama
        },
    },
    # ... å…¶ä»–é…ç½®
}

# å½“å‰é…ç½®
CURRENT_CONFIG_NAME = "high_quality_local"
CURRENT_CONFIG = dict(AVAILABLE_CONFIGS[CURRENT_CONFIG_NAME]["config"])

def get_available_configs():
    """
    è¿”å›å¯é€‰æ¨¡å‹é…ç½®åˆ—è¡¨ï¼ˆä¸åŒ…å«æ•æ„Ÿä¿¡æ¯ï¼‰
    
    è¿”å›æ ¼å¼ï¼š
    [
        {
            "key": "deepseek_api",
            "name": "DeepSeek API",
            "description": "äº‘ç«¯æ¨ç†ï¼Œå…éƒ¨ç½²...",
            "llm": "deepseek-chat",
            "use_api": True,
            "context_window": 32768
        },
        ...
    ]
    """
    options = []
    for key, info in AVAILABLE_CONFIGS.items():
        config = info["config"]
        options.append({
            "key": key,
            "name": info["name"],
            "description": info.get("description", ""),
            "llm": config.get("llm", ""),
            "use_api": config.get("use_api", False),
            "context_window": config.get("context_window"),
        })
    return options

def get_current_config_name() -> str:
    """è¿”å›å½“å‰ç”Ÿæ•ˆçš„é…ç½® key"""
    return CURRENT_CONFIG_NAME

def set_current_config(name: str) -> dict:
    """
    åˆ‡æ¢å½“å‰é…ç½®
    
    æµç¨‹ï¼š
    1. éªŒè¯é…ç½®åç§°æ˜¯å¦æœ‰æ•ˆ
    2. æ›´æ–°å…¨å±€é…ç½®å­—å…¸
    3. æ›´æ–°å½“å‰é…ç½®åç§°
    4. è¿”å›æ–°é…ç½®
    
    æ³¨æ„ï¼šä½¿ç”¨ clear() å’Œ update() ä¿æŒåŒä¸€ä¸ª CURRENT_CONFIG å¼•ç”¨ï¼Œ
    è¿™æ ·å…¶ä»–æ¨¡å—å¼•ç”¨ CURRENT_CONFIG æ—¶è‡ªåŠ¨è·å¾—æ–°é…ç½®
    """
    global CURRENT_CONFIG_NAME
    if name not in AVAILABLE_CONFIGS:
        raise KeyError(f"æœªçŸ¥çš„æ¨¡å‹é…ç½®: {name}")

    config = AVAILABLE_CONFIGS[name]["config"]
    CURRENT_CONFIG.clear()  # æ¸…ç©ºå½“å‰é…ç½®
    CURRENT_CONFIG.update(config)  # æ›´æ–°ä¸ºæ–°é…ç½®
    CURRENT_CONFIG_NAME = name
    return CURRENT_CONFIG
```

#### 2.2.2 APIæ¥å£ï¼ˆ`api.py`ï¼‰

**è·å–æ¨¡å‹åˆ—è¡¨æ¥å£**ï¼š

```python
@router.get("/models", response={200: ModelsOut})
def list_models(request):
    """
    è·å–å¯ç”¨æ¨¡å‹é…ç½®åˆ—è¡¨
    
    è¿”å›ï¼š
    {
        "current": "deepseek_api",  # å½“å‰æ¨¡å‹é…ç½®key
        "options": [                # å¯ç”¨æ¨¡å‹åˆ—è¡¨
            {
                "key": "deepseek_api",
                "name": "DeepSeek API",
                "description": "äº‘ç«¯æ¨ç†ï¼Œå…éƒ¨ç½²...",
                "llm": "deepseek-chat",
                "use_api": True,
                "context_window": 32768
            },
            ...
        ]
    }
    """
    options = get_available_configs()
    current = get_current_config_name()
    
    return {"current": current, "options": options}
```

**åˆ‡æ¢æ¨¡å‹æ¥å£**ï¼š

```python
@router.post("/models/switch", response={200: ModelsOut, 400: ErrorResponse})
def switch_model(request, data: ModelSwitchIn):
    """
    åˆ‡æ¢æ¨¡å‹é…ç½®
    
    è¯·æ±‚ä½“ï¼š
    {
        "model_key": "deepseek_api"  # è¦åˆ‡æ¢çš„æ¨¡å‹é…ç½®key
    }
    
    æµç¨‹ï¼š
    1. éªŒè¯ç”¨æˆ·èº«ä»½ï¼ˆé€šè¿‡API Keyï¼‰
    2. åˆ‡æ¢æ¨¡å‹é…ç½®ï¼ˆset_current_configï¼‰
    3. é‡ç½®æ—¥å¿—ç³»ç»Ÿï¼ˆreset_log_systemï¼‰
    4. è¿”å›æ›´æ–°åçš„æ¨¡å‹åˆ—è¡¨å’Œå½“å‰æ¨¡å‹
    
    é‡è¦ï¼šé‡ç½®æ—¥å¿—ç³»ç»Ÿæ˜¯ä¸ºäº†ç¡®ä¿æ–°æ¨¡å‹é…ç½®ç”Ÿæ•ˆï¼Œ
    å› ä¸º TopKLogSystem åœ¨åˆå§‹åŒ–æ—¶ä¼šè¯»å– CURRENT_CONFIG
    """
    try:
        # 1. åˆ‡æ¢é…ç½®
        set_current_config(data.model_key)
        
        # 2. é‡ç½®æ—¥å¿—ç³»ç»Ÿï¼ˆå…³é”®æ­¥éª¤ï¼‰
        # è¿™ä¼šæ¸…é™¤æ—§çš„ TopKLogSystem å®ä¾‹ï¼Œä¸‹æ¬¡è°ƒç”¨æ—¶ä¼šç”¨æ–°é…ç½®é‡æ–°åˆå§‹åŒ–
        services.reset_log_system()
        
        print(f"ğŸ§  [æ¨¡å‹åˆ‡æ¢æˆåŠŸ] å½“å‰æ¨¡å‹: {get_current_config_name()}")
    except KeyError:
        print(f"âŒ [æ¨¡å‹åˆ‡æ¢å¤±è´¥] æ— æ•ˆçš„æ¨¡å‹æ ‡è¯†: {data.model_key}")
        return 400, {"error": "æ— æ•ˆçš„æ¨¡å‹æ ‡è¯†"}

    # 3. è¿”å›æ›´æ–°åçš„é…ç½®
    options = get_available_configs()
    current = get_current_config_name()
    
    return {"current": current, "options": options}
```

#### 2.2.3 æœåŠ¡å±‚ï¼ˆ`services.py`ï¼‰

**é‡ç½®æ—¥å¿—ç³»ç»Ÿ**ï¼š

```python
def reset_log_system():
    """
    åœ¨æ¨¡å‹é…ç½®åˆ‡æ¢åé‡ç½® TopKLogSystem å®ä¾‹
    
    åŸç†ï¼š
    - TopKLogSystem æ˜¯å•ä¾‹æ¨¡å¼ï¼Œåˆå§‹åŒ–æ—¶ä¼šè¯»å– CURRENT_CONFIG
    - åˆ‡æ¢é…ç½®åï¼Œéœ€è¦æ¸…é™¤æ—§å®ä¾‹ï¼Œè®©ç³»ç»Ÿç”¨æ–°é…ç½®é‡æ–°åˆå§‹åŒ–
    - ä½¿ç”¨çº¿ç¨‹é”ç¡®ä¿çº¿ç¨‹å®‰å…¨
    """
    global _log_system_instance

    with _log_system_lock:
        if _log_system_instance is not None:
            import logging
            logger = logging.getLogger(__name__)
            logger.info("é‡ç½® TopKLogSystem å®ä¾‹ä»¥åº”ç”¨æ–°çš„æ¨¡å‹é…ç½®")
            _log_system_instance = None  # æ¸…é™¤å®ä¾‹ï¼Œä¸‹æ¬¡è°ƒç”¨æ—¶é‡æ–°åˆå§‹åŒ–
```

### 2.3 å‰ç«¯å®ç°

#### 2.3.1 APIè°ƒç”¨å±‚ï¼ˆ`api.js`ï¼‰

```javascript
export default {
  // è·å–å¯ç”¨æ¨¡å‹é…ç½®
  getModels() {
    return api.get('/models');
  },

  // åˆ‡æ¢å½“å‰æ¨¡å‹
  switchModel(modelKey) {
    return api.post('/models/switch', { model_key: modelKey });
  },
};
```

#### 2.3.2 çŠ¶æ€ç®¡ç†ï¼ˆ`store.js`ï¼‰

```javascript
export const useStore = defineStore('main', {
  state: () => ({
    currentModel: localStorage.getItem('currentModel') || '',  // å½“å‰æ¨¡å‹key
    models: [],  // æ¨¡å‹åˆ—è¡¨
  }),
  
  actions: {
    // ä¿å­˜æ¨¡å‹åˆ—è¡¨
    setModelOptions(options) {
      this.models = options || [];
    },

    // æ›´æ–°å½“å‰æ¨¡å‹
    setCurrentModel(modelKey) {
      this.currentModel = modelKey;
      if (modelKey) {
        localStorage.setItem('currentModel', modelKey);  // æŒä¹…åŒ–åˆ°æœ¬åœ°å­˜å‚¨
      } else {
        localStorage.removeItem('currentModel');
      }
    },
  }
});
```

#### 2.3.3 è®¾ç½®ç•Œé¢ï¼ˆ`Settings.vue`ï¼‰

```vue
<template>
  <div class="settings-modal">
    <div class="settings-section">
      <h3>æ¨¡å‹é€‰æ‹©</h3>
      <div class="setting-item">
        <label>å½“å‰æ¨¡å‹</label>
        <div class="model-select">
          <!-- æ¨¡å‹é€‰æ‹©ä¸‹æ‹‰æ¡† -->
          <select v-model="selectedModel">
            <option v-for="opt in models" :key="opt.key" :value="opt.key">
              {{ opt.name }} â€” {{ opt.llm }}
            </option>
          </select>
          <!-- åˆ‡æ¢æŒ‰é’® -->
          <button class="switch-btn" @click="switchModel">åˆ‡æ¢</button>
        </div>
        <p class="help-text">
          åˆ‡æ¢æ¨¡å‹ä¼šåœ¨åç«¯é‡æ–°åˆå§‹åŒ–æ¨¡å‹å®ä¾‹ï¼ˆå¯èƒ½éœ€è¦ä¸€äº›æ—¶é—´ï¼‰ã€‚
          å¦‚æœåˆ‡æ¢åˆ°æœ¬åœ°æ¨¡å‹ï¼Œè¯·ç¡®è®¤å·²åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œ ollama pullã€‚
        </p>
      </div>
    </div>
  </div>
</template>

<script setup>
import { ref, onMounted } from 'vue';
import { useStore } from '../store';
import api from '../api';

const store = useStore();
const models = ref([]);
const selectedModel = ref('');

// ç»„ä»¶æŒ‚è½½æ—¶åŠ è½½æ¨¡å‹åˆ—è¡¨
onMounted(() => {
  if (store.models && store.models.length > 0) {
    // ä»storeè·å–ï¼ˆChat.vueå·²ç»åŠ è½½è¿‡ï¼‰
    models.value = store.models;
    selectedModel.value = store.currentModel || models.value[0]?.key;
  } else {
    // ä»APIåŠ è½½
    api.getModels().then(resp => {
      const data = resp?.data || {};
      models.value = data.options || [];
      selectedModel.value = data.current || models.value[0]?.key;
      store.setModelOptions(models.value);
      store.setCurrentModel(selectedModel.value);
    });
  }
});

// åˆ‡æ¢æ¨¡å‹
const switchModel = async () => {
  if (!selectedModel.value) return;
  try {
    const resp = await api.switchModel(selectedModel.value);
    const data = resp?.data || {};
    
    // æ›´æ–°store
    if (data.options) store.setModelOptions(data.options);
    if (data.current) store.setCurrentModel(data.current);
    
    alert('æ¨¡å‹åˆ‡æ¢æˆåŠŸ: ' + data.current);
  } catch (err) {
    alert('æ¨¡å‹åˆ‡æ¢å¤±è´¥: ' + (err.response?.data?.error || err.message));
  }
};
</script>
```

#### 2.3.4 è¾“å…¥ç»„ä»¶ï¼ˆ`ChatInput.vue`ï¼‰

```vue
<template>
  <div class="chat-input-wrapper">
    <div class="select-row">
      <!-- æ¨¡å‹é€‰æ‹©ä¸‹æ‹‰æ¡† -->
      <select
        v-model="selectedModel"
        class="query-type-select model-select"
        :disabled="loading || modelOptions.length === 0"
        @change="handleModelChange"
      >
        <option value="" disabled>é€‰æ‹©æ¨¡å‹</option>
        <option
          v-for="model in modelOptions"
          :key="model.key"
          :value="model.key"
        >
          {{ model.name }}
        </option>
      </select>
    </div>
    <!-- ... å…¶ä»–è¾“å…¥ç»„ä»¶ ... -->
  </div>
</template>

<script setup>
import { ref, computed, onMounted } from 'vue';
import { useStore } from '../store';
import api from '../api';

const store = useStore();
const modelOptions = computed(() => store.models);
const selectedModel = ref(store.currentModel || '');

// æ¨¡å‹åˆ‡æ¢å¤„ç†
const handleModelChange = async () => {
  const targetModel = selectedModel.value;
  if (!targetModel) return;

  const previousModel = store.currentModel;
  try {
    // è°ƒç”¨APIåˆ‡æ¢æ¨¡å‹
    const response = await api.switchModel(targetModel);
    const data = response?.data || {};

    // æ›´æ–°store
    if (data.options) {
      store.setModelOptions(data.options);
    }
    if (data.current) {
      store.setCurrentModel(data.current);
    } else {
      store.setCurrentModel(targetModel);
    }

    // æ˜¾ç¤ºåˆ‡æ¢æˆåŠŸä¿¡æ¯
    const currentKey = data.current || targetModel;
    const currentInfo = (data.options || modelOptions.value).find(
      (item) => item.key === currentKey
    );
    if (currentInfo) {
      showInfoModal.value = true;
      infoModalContent.value = {
        title: `æ¨¡å‹åˆ‡æ¢è‡³ ${currentInfo.name}`,
        message: `LLM: ${currentInfo.llm}\nè¿è¡Œæ¨¡å¼: ${currentInfo.use_api ? "äº‘ç«¯ API" : "æœ¬åœ° Ollama"}`,
      };
    }
  } catch (err) {
    console.error("åˆ‡æ¢æ¨¡å‹å¤±è´¥:", err);
    store.setError(err?.response?.data?.error || "æ¨¡å‹åˆ‡æ¢å¤±è´¥");
    selectedModel.value = previousModel;  // æ¢å¤åŸæ¨¡å‹
  }
};
</script>
```

### 2.4 æ¨¡å‹åˆ‡æ¢æµç¨‹å›¾

```mermaid
sequenceDiagram
    participant U as ç”¨æˆ·
    participant S as Settings.vue / ChatInput.vue
    participant API as api.js
    participant Store as store.js
    participant Backend as api.py
    participant Config as model_config.py
    participant Service as services.py
    participant System as TopKLogSystem
    
    U->>S: é€‰æ‹©æ–°æ¨¡å‹å¹¶ç‚¹å‡»åˆ‡æ¢
    S->>API: switchModel(modelKey)
    API->>Backend: POST /api/models/switch
    Note over API,Backend: {model_key: "deepseek_api"}
    
    Backend->>Backend: éªŒè¯API Key
    Backend->>Config: set_current_config(model_key)
    Config->>Config: éªŒè¯é…ç½®æ˜¯å¦å­˜åœ¨
    Config->>Config: æ›´æ–° CURRENT_CONFIG
    Config->>Config: æ›´æ–° CURRENT_CONFIG_NAME
    Config-->>Backend: è¿”å›æ–°é…ç½®
    
    Backend->>Service: reset_log_system()
    Service->>Service: æ¸…é™¤ _log_system_instance
    Note over Service: ä¸‹æ¬¡è°ƒç”¨æ—¶ç”¨æ–°é…ç½®é‡æ–°åˆå§‹åŒ–
    
    Backend->>Config: get_available_configs()
    Backend->>Config: get_current_config_name()
    Config-->>Backend: è¿”å›æ¨¡å‹åˆ—è¡¨å’Œå½“å‰æ¨¡å‹
    
    Backend-->>API: {current: "deepseek_api", options: [...]}
    API-->>S: è¿”å›å“åº”æ•°æ®
    S->>Store: setModelOptions(options)
    S->>Store: setCurrentModel(current)
    Store->>Store: ä¿å­˜åˆ°localStorage
    S->>S: æ˜¾ç¤ºåˆ‡æ¢æˆåŠŸä¿¡æ¯
    S-->>U: æ¨¡å‹åˆ‡æ¢å®Œæˆ
    
    Note over System: ä¸‹æ¬¡è°ƒç”¨ get_log_system() æ—¶ï¼Œ<br/>ä¼šç”¨æ–°é…ç½®é‡æ–°åˆå§‹åŒ–
```

---

## ä¸‰ã€æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½

### 3.1 ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      å‰ç«¯ (Vue.js)                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ ChatInput.vueâ”‚  â”‚   store.js   â”‚  â”‚   api.js     â”‚    â”‚
â”‚  â”‚  æ–‡ä»¶ä¸Šä¼ UI  â”‚  â”‚  æ–‡ä»¶ç®¡ç†    â”‚  â”‚  APIè°ƒç”¨     â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚         â”‚                  â”‚                  â”‚            â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                            â”‚                               â”‚
â”‚                            â–¼                               â”‚
â”‚              POST /api/files/upload (multipart/form-data)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      åç«¯ (Django)                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚   api.py     â”‚  â”‚ æ–‡ä»¶å­˜å‚¨ç³»ç»Ÿ  â”‚  â”‚ æ–‡ä»¶è§£æ     â”‚    â”‚
â”‚  â”‚ upload_file  â”‚  â”‚ data/uploads â”‚  â”‚ (.txt/.docx) â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚         â”‚                  â”‚                  â”‚            â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                            â”‚                               â”‚
â”‚                            â–¼                               â”‚
â”‚                   è¿”å›æ–‡ä»¶è·¯å¾„å’Œå…ƒæ•°æ®                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   èŠå¤©ä¸­ä½¿ç”¨æ–‡ä»¶                             â”‚
â”‚  - ç”¨æˆ·è¾“å…¥ä¸­å¼•ç”¨æ–‡ä»¶è·¯å¾„ (data/uploads/xxx)                â”‚
â”‚  - åç«¯è‡ªåŠ¨è¯»å–æ–‡ä»¶å†…å®¹                                      â”‚
â”‚  - é™„åŠ åˆ°ç”¨æˆ·è¾“å…¥ï¼Œä¾›RAGå’ŒLLMä½¿ç”¨                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 åç«¯å®ç°

#### 3.2.1 æ–‡ä»¶ä¸Šä¼ æ¥å£ï¼ˆ`api.py`ï¼‰

```python
# æ–‡ä»¶ä¸Šä¼ é…ç½®
UPLOAD_ROOT = Path(settings.BASE_DIR) / "data" / "uploads"
MAX_UPLOAD_SIZE = getattr(settings, "MAX_UPLOAD_SIZE", 20 * 1024 * 1024)  # é»˜è®¤ 20MB

@router.post("/files/upload", response={200: FileUploadOut, 400: ErrorResponse, 401: ErrorResponse})
def upload_file(request, file: UploadedFile = File(...)):
    """
    æ–‡ä»¶ä¸Šä¼ æ¥å£
    
    è¯·æ±‚ï¼š
    - Content-Type: multipart/form-data
    - Body: file (æ–‡ä»¶å¯¹è±¡)
    
    æµç¨‹ï¼š
    1. éªŒè¯ç”¨æˆ·èº«ä»½ï¼ˆAPI Keyï¼‰
    2. éªŒè¯æ–‡ä»¶æ˜¯å¦å­˜åœ¨
    3. éªŒè¯æ–‡ä»¶å¤§å°ï¼ˆä¸è¶…è¿‡20MBï¼‰
    4. ç”Ÿæˆå”¯ä¸€æ–‡ä»¶åï¼ˆUUIDï¼‰
    5. ä¿å­˜æ–‡ä»¶åˆ° data/uploads ç›®å½•
    6. è¿”å›æ–‡ä»¶å…ƒæ•°æ®ï¼ˆåŸå§‹æ–‡ä»¶åã€å­˜å‚¨æ–‡ä»¶åã€è·¯å¾„ç­‰ï¼‰
    
    æ”¯æŒçš„æ–‡ä»¶æ ¼å¼ï¼š
    - æ–‡æœ¬æ–‡ä»¶ï¼š.txt, .md, .json, .jsonl, .csv
    - æ–‡æ¡£æ–‡ä»¶ï¼š.docxï¼ˆWordæ–‡æ¡£ï¼‰
    - å…¶ä»–æ ¼å¼ï¼šä¸Šä¼ æˆåŠŸï¼Œä½†å†…å®¹è§£æå¯èƒ½åœ¨èŠå¤©æ—¶å¤±è´¥
    """
    # 1. éªŒè¯ç”¨æˆ·èº«ä»½
    if not request.auth:
        return 401, {"error": "è¯·å…ˆç™»å½•è·å–API Key"}

    # 2. éªŒè¯æ–‡ä»¶
    if not file:
        return 400, {"error": "è¯·é€‰æ‹©è¦ä¸Šä¼ çš„æ–‡ä»¶"}

    # 3. éªŒè¯æ–‡ä»¶å¤§å°
    if file.size > MAX_UPLOAD_SIZE:
        max_size_mb = round(MAX_UPLOAD_SIZE / (1024 * 1024))
        return 400, {"error": f"æ–‡ä»¶è¿‡å¤§ï¼Œæœ€å¤§æ”¯æŒ {max_size_mb}MB"}

    # 4. ç”Ÿæˆå”¯ä¸€æ–‡ä»¶å
    original_filename = file.name
    extension = Path(original_filename).suffix  # è·å–æ–‡ä»¶æ‰©å±•å
    stored_filename = f"{uuid4().hex}{extension}"  # UUID + æ‰©å±•å

    try:
        # 5. åˆ›å»ºä¸Šä¼ ç›®å½•ï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰
        UPLOAD_ROOT.mkdir(parents=True, exist_ok=True)
        destination_path = UPLOAD_ROOT / stored_filename

        # 6. ä¿å­˜æ–‡ä»¶
        with destination_path.open("wb+") as destination:
            for chunk in file.chunks():  # åˆ†å—å†™å…¥ï¼Œæ”¯æŒå¤§æ–‡ä»¶
                destination.write(chunk)

        # 7. è®¡ç®—ç›¸å¯¹è·¯å¾„ï¼ˆç›¸å¯¹äºé¡¹ç›®æ ¹ç›®å½•ï¼‰
        relative_path = destination_path.relative_to(Path(settings.BASE_DIR))

        # 8. è¿”å›æ–‡ä»¶å…ƒæ•°æ®
        return {
            "original_filename": original_filename,  # åŸå§‹æ–‡ä»¶å
            "stored_filename": stored_filename,      # å­˜å‚¨æ–‡ä»¶åï¼ˆUUIDï¼‰
            "size": file.size,                       # æ–‡ä»¶å¤§å°ï¼ˆå­—èŠ‚ï¼‰
            "relative_path": str(relative_path),     # ç›¸å¯¹è·¯å¾„ï¼ˆå¦‚ data/uploads/xxx.txtï¼‰
        }
    except Exception as exc:
        logger.exception("æ–‡ä»¶ä¸Šä¼ å¤±è´¥")
        return 400, {"error": f"æ–‡ä»¶ä¸Šä¼ å¤±è´¥: {exc}"}
```

#### 3.2.2 æ–‡ä»¶å†…å®¹è§£æï¼ˆ`api.py`ï¼‰

**åœ¨èŠå¤©æ¥å£ä¸­è§£ææ–‡ä»¶å†…å®¹**ï¼š

```python
@router.post("/chat", response={200: ChatOut, 401: ErrorResponse})
def chat(request, data: ChatIn):
    """
    èŠå¤©æ¥å£ - æ”¯æŒæ–‡ä»¶å†…å®¹é™„åŠ 
    
    æµç¨‹ï¼š
    1. æ£€æŸ¥ç”¨æˆ·è¾“å…¥ä¸­æ˜¯å¦åŒ…å«æ–‡ä»¶è·¯å¾„å¼•ç”¨ï¼ˆdata/uploads/xxxï¼‰
    2. å¦‚æœåŒ…å«ï¼Œè¯»å–æ–‡ä»¶å†…å®¹
    3. æ ¹æ®æ–‡ä»¶ç±»å‹è§£æå†…å®¹ï¼ˆæ–‡æœ¬æ–‡ä»¶ç›´æ¥è¯»å–ï¼Œdocxè§£æXMLï¼‰
    4. å°†æ–‡ä»¶å†…å®¹é™„åŠ åˆ°ç”¨æˆ·è¾“å…¥
    5. åç»­RAGå’ŒLLMå¤„ç†æ—¶å¯ä»¥ä½¿ç”¨æ–‡ä»¶å†…å®¹
    """
    user_input = data.user_input.strip()
    
    # å¤„ç†ä¸Šä¼ æ–‡ä»¶å¼•ç”¨
    try:
        # 1. æŸ¥æ‰¾ç”¨æˆ·è¾“å…¥ä¸­çš„æ–‡ä»¶è·¯å¾„
        file_paths = re.findall(r"data/uploads/[\w\-\.]+", user_input)
        attached_texts = []
        
        for rel in file_paths:
            # 2. æ„å»ºç»å¯¹è·¯å¾„
            abs_path = _Path(settings.BASE_DIR) / rel
            
            if abs_path.exists():
                try:
                    suffix = abs_path.suffix.lower()
                    text_content = None
                    
                    # 3. æ ¹æ®æ–‡ä»¶ç±»å‹è§£æå†…å®¹
                    if suffix in ['.txt', '.md', '.json', '.jsonl', '.csv']:
                        # æ–‡æœ¬æ–‡ä»¶ï¼šç›´æ¥è¯»å–
                        with abs_path.open('r', encoding='utf-8', errors='ignore') as f:
                            text_content = f.read()
                    
                    elif suffix == '.docx':
                        # Wordæ–‡æ¡£ï¼šè§£æXML
                        def _extract_docx_text(path: _Path) -> str:
                            """ä»docxæ–‡ä»¶ä¸­æå–æ–‡æœ¬å†…å®¹"""
                            with zipfile.ZipFile(str(path)) as zf:
                                if 'word/document.xml' not in zf.namelist():
                                    return ''
                                xml_content = zf.read('word/document.xml')
                            
                            # è§£æXML
                            root = ET.fromstring(xml_content)
                            ns = {'w': 'http://schemas.openxmlformats.org/wordprocessingml/2006/main'}
                            paragraphs = []
                            
                            # æå–æ‰€æœ‰æ®µè½æ–‡æœ¬
                            for p in root.findall('.//w:p', ns):
                                texts = [t.text for t in p.findall('.//w:t', ns) if t.text]
                                if texts:
                                    paragraphs.append(''.join(texts))
                            
                            return '\n'.join(paragraphs)
                        
                        text_content = _extract_docx_text(abs_path)
                    
                    else:
                        # ä¸æ”¯æŒçš„æ ¼å¼
                        text_content = None

                    # 4. é™„åŠ æ–‡ä»¶å†…å®¹åˆ°ç”¨æˆ·è¾“å…¥
                    if text_content:
                        attached_texts.append((rel, text_content))
                        print(f"ğŸ“ [é™„åŠ æ–‡ä»¶] ä» {rel} è¯»å–å†…å®¹ï¼Œé•¿åº¦: {len(text_content)} å­—ç¬¦")
                    else:
                        print(f"âš ï¸ [é™„åŠ æ–‡ä»¶] æ— æ³•è§£ææ–‡ä»¶å†…å®¹: {rel} (suffix={suffix})")
                
                except Exception as e:
                    print(f"âš ï¸ [é™„åŠ æ–‡ä»¶] è¯»å–å¤±è´¥ {rel}: {e}")
            else:
                print(f"âš ï¸ [é™„åŠ æ–‡ä»¶] æ–‡ä»¶ä¸å­˜åœ¨: {rel}")

        # 5. å°†æ–‡ä»¶å†…å®¹é™„åŠ åˆ°ç”¨æˆ·è¾“å…¥
        if attached_texts:
            additions = []
            for rel, txt in attached_texts:
                additions.append(f"\n\n[é™„ä»¶: {rel} å†…å®¹å¼€å§‹]\n{txt}\n[é™„ä»¶: {rel} å†…å®¹ç»“æŸ]\n")
            user_input = user_input + "\n" + "\n".join(additions)
    
    except Exception as _e:
        print(f"âš ï¸ [é™„åŠ æ–‡ä»¶] å¤„ç†ä¸Šä¼ æ–‡ä»¶æ—¶å‡ºé”™: {_e}")
    
    # 6. ç»§ç»­æ­£å¸¸çš„èŠå¤©æµç¨‹ï¼ˆRAGã€LLMè°ƒç”¨ç­‰ï¼‰
    # ...
```

### 3.3 å‰ç«¯å®ç°

#### 3.3.1 APIè°ƒç”¨å±‚ï¼ˆ`api.js`ï¼‰

```javascript
export default {
  // ä¸Šä¼ æ–‡ä»¶
  uploadFile(formData, config = {}) {
    return api.post('/files/upload', formData, {
      headers: {
        'Content-Type': 'multipart/form-data',  // å¿…é¡»è®¾ç½®ä¸ºmultipart/form-data
      },
      ...config,  // æ”¯æŒä¼ å…¥é¢å¤–é…ç½®ï¼ˆå¦‚ä¸Šä¼ è¿›åº¦å›è°ƒï¼‰
    });
  },
};
```

#### 3.3.2 çŠ¶æ€ç®¡ç†ï¼ˆ`store.js`ï¼‰

```javascript
export const useStore = defineStore('main', {
  state: () => ({
    // ä¼šè¯æ–‡ä»¶æ˜ å°„ï¼š{ sessionId: [{ name, path, stored }] }
    sessionFiles: (() => {
      try {
        return JSON.parse(localStorage.getItem('sessionFiles') || '{}') || {};
      } catch (err) {
        console.error('Failed to parse sessionFiles from localStorage', err);
        return {};
      }
    })()
  }),
  
  actions: {
    // æ·»åŠ ä¸Šä¼ çš„æ–‡ä»¶
    addUploadedFile(sessionId, fileMeta) {
      if (!sessionId || !fileMeta || !fileMeta.path) return;

      // åˆå§‹åŒ–ä¼šè¯æ–‡ä»¶åˆ—è¡¨
      if (!this.sessionFiles[sessionId]) {
        this.sessionFiles[sessionId] = [];
      }

      // æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å·²å­˜åœ¨ï¼ˆé¿å…é‡å¤ï¼‰
      const exists = this.sessionFiles[sessionId].some(
        (item) => item.path === fileMeta.path
      );

      if (!exists) {
        this.sessionFiles[sessionId].push({
          name: fileMeta.name || fileMeta.path,
          path: fileMeta.path,
          stored: fileMeta.stored || null,
        });
        // æŒä¹…åŒ–åˆ°æœ¬åœ°å­˜å‚¨
        localStorage.setItem('sessionFiles', JSON.stringify(this.sessionFiles));
      }
    },

    // è·å–ä¼šè¯æ–‡ä»¶åˆ—è¡¨
    getSessionFiles(sessionId) {
      return this.sessionFiles[sessionId] || [];
    },

    // æ¸…ç©ºä¼šè¯æ–‡ä»¶
    clearSessionFiles(sessionId) {
      if (this.sessionFiles[sessionId]) {
        delete this.sessionFiles[sessionId];
        localStorage.setItem('sessionFiles', JSON.stringify(this.sessionFiles));
      }
    }
  }
});
```

#### 3.3.3 è¾“å…¥ç»„ä»¶ï¼ˆ`ChatInput.vue`ï¼‰

```vue
<template>
  <div class="chat-input-wrapper">
    <div class="messageBox">
      <!-- æ–‡ä»¶ä¸Šä¼ æŒ‰é’® -->
      <div class="fileUploadWrapper">
        <label for="file" :class="{ disabled: uploadingFile || loading }">
          <svg><!-- ä¸Šä¼ å›¾æ ‡ --></svg>
          <span class="tooltip">æ·»åŠ æ–‡ä»¶</span>
        </label>
        <input
          type="file"
          id="file"
          name="file"
          @change="handleFileUpload"
          :disabled="uploadingFile || loading"
        />
        <!-- ä¸Šä¼ è¿›åº¦ -->
        <div class="uploadStatus" v-if="uploadingFile">
          ä¸Šä¼ ä¸­ {{ uploadProgress }}%
        </div>
        <!-- ä¸Šä¼ æˆåŠŸæç¤º -->
        <div class="uploadStatus success" v-else-if="lastUploadedFile">
          å·²ä¸Šä¼ ï¼š{{ lastUploadedFile.name }}
        </div>
      </div>
      
      <!-- æ¶ˆæ¯è¾“å…¥æ¡† -->
      <textarea
        v-model="message"
        placeholder="è¾“å…¥æ¶ˆæ¯..."
        @keyup.enter.exact="sendMessage"
      ></textarea>
    </div>
  </div>
</template>

<script setup>
import { ref } from 'vue';
import { useStore } from '../store';
import api from '../api';

const store = useStore();
const uploadingFile = ref(false);
const uploadProgress = ref(0);
const lastUploadedFile = ref(null);

// æ–‡ä»¶ä¸Šä¼ å¤„ç†
const handleFileUpload = async (event) => {
  const file = event.target.files[0];
  if (!file || uploadingFile.value) {
    return;
  }

  // 1. åˆ›å»ºFormDataå¯¹è±¡
  const formData = new FormData();
  formData.append("file", file);

  // 2. è®¾ç½®ä¸Šä¼ çŠ¶æ€
  uploadingFile.value = true;
  uploadProgress.value = 0;

  try {
    // 3. è°ƒç”¨APIä¸Šä¼ æ–‡ä»¶
    const response = await api.uploadFile(formData, {
      onUploadProgress: (progressEvent) => {
        // æ›´æ–°ä¸Šä¼ è¿›åº¦
        if (progressEvent.total) {
          uploadProgress.value = Math.min(
            100,
            Math.round((progressEvent.loaded / progressEvent.total) * 100)
          );
        }
      },
    });

    const data = response?.data || {};
    const displayName = data.original_filename || file.name;

    // 4. ä¿å­˜ä¸Šä¼ æ–‡ä»¶ä¿¡æ¯
    lastUploadedFile.value = {
      name: displayName,
    };

    // 5. æ·»åŠ åˆ°storeï¼ˆä¼šè¯æ–‡ä»¶åˆ—è¡¨ï¼‰
    if (data.relative_path) {
      store.addUploadedFile(store.currentSession, {
        name: displayName,
        path: data.relative_path,
        stored: data.stored_filename,
      });
    }

    // 6. æ˜¾ç¤ºä¸Šä¼ æˆåŠŸä¿¡æ¯ï¼ˆ5åˆ†é’Ÿåè‡ªåŠ¨æ¸…é™¤ï¼‰
    if (uploadStatusTimer) {
      clearTimeout(uploadStatusTimer);
    }
    uploadStatusTimer = setTimeout(() => {
      lastUploadedFile.value = null;
    }, 5 * 60 * 1000);

    // 7. æ˜¾ç¤ºæˆåŠŸæ¨¡æ€æ¡†
    infoModalContent.value = {
      title: "æ–‡ä»¶ä¸Šä¼ æˆåŠŸ",
      message: [
        `æ–‡ä»¶åç§°ï¼š${displayName}`,
        `æ–‡ä»¶å¤§å°ï¼š${Math.round((data.size || file.size) / 1024)} KB`,
      ].join("\n"),
    };
    showInfoModal.value = true;
  } catch (err) {
    console.error("æ–‡ä»¶ä¸Šä¼ å¤±è´¥:", err);
    store.setError(err?.response?.data?.error || "æ–‡ä»¶ä¸Šä¼ å¤±è´¥");
  } finally {
    uploadingFile.value = false;
    uploadProgress.value = 0;
    // æ¸…ç©ºæ–‡ä»¶é€‰æ‹©ï¼ˆå…è®¸é‡å¤ä¸Šä¼ åŒä¸€æ–‡ä»¶ï¼‰
    if (event.target) {
      event.target.value = "";
    }
  }
};
</script>
```

### 3.4 æ–‡ä»¶ä¸Šä¼ å’Œä½¿ç”¨æµç¨‹å›¾

```mermaid
sequenceDiagram
    participant U as ç”¨æˆ·
    participant CI as ChatInput.vue
    participant API as api.js
    participant Store as store.js
    participant Backend as api.py
    participant FS as æ–‡ä»¶ç³»ç»Ÿ
    participant Chat as chatæ¥å£
    
    U->>CI: é€‰æ‹©æ–‡ä»¶å¹¶ä¸Šä¼ 
    CI->>CI: åˆ›å»ºFormDataå¯¹è±¡
    CI->>API: uploadFile(formData)
    API->>Backend: POST /api/files/upload
    Note over API,Backend: multipart/form-data
    
    Backend->>Backend: éªŒè¯API Key
    Backend->>Backend: éªŒè¯æ–‡ä»¶å¤§å°
    Backend->>Backend: ç”ŸæˆUUIDæ–‡ä»¶å
    Backend->>FS: ä¿å­˜æ–‡ä»¶åˆ° data/uploads/
    FS-->>Backend: æ–‡ä»¶ä¿å­˜æˆåŠŸ
    Backend-->>API: è¿”å›æ–‡ä»¶å…ƒæ•°æ®
    Note over Backend,API: {original_filename, stored_filename,<br/>size, relative_path}
    
    API-->>CI: è¿”å›å“åº”æ•°æ®
    CI->>Store: addUploadedFile(sessionId, fileMeta)
    Store->>Store: ä¿å­˜åˆ°localStorage
    CI->>CI: æ˜¾ç¤ºä¸Šä¼ æˆåŠŸæç¤º
    CI-->>U: æ–‡ä»¶ä¸Šä¼ å®Œæˆ
    
    Note over U,Chat: ç”¨æˆ·åœ¨èŠå¤©ä¸­ä½¿ç”¨æ–‡ä»¶
    
    U->>CI: è¾“å…¥æ¶ˆæ¯å¹¶å¼•ç”¨æ–‡ä»¶è·¯å¾„
    Note over U,CI: ä¾‹å¦‚: "åˆ†æè¿™ä¸ªæ–‡ä»¶ data/uploads/xxx.txt"
    CI->>API: chat(userInput, queryType)
    API->>Backend: POST /api/chat
    Note over API,Backend: {user_input: "... data/uploads/xxx.txt ..."}
    
    Backend->>Backend: æŸ¥æ‰¾æ–‡ä»¶è·¯å¾„å¼•ç”¨
    Backend->>FS: è¯»å–æ–‡ä»¶å†…å®¹
    FS-->>Backend: è¿”å›æ–‡ä»¶å†…å®¹
    Backend->>Backend: è§£ææ–‡ä»¶å†…å®¹
    Note over Backend: æ–‡æœ¬æ–‡ä»¶ç›´æ¥è¯»å–ï¼Œ<br/>docxè§£æXML
    Backend->>Backend: é™„åŠ æ–‡ä»¶å†…å®¹åˆ°user_input
    Note over Backend: user_input += "\n[é™„ä»¶: ... å†…å®¹å¼€å§‹]\n...\n[é™„ä»¶: ... å†…å®¹ç»“æŸ]"
    
    Backend->>Chat: å¤„ç†èŠå¤©è¯·æ±‚ï¼ˆRAGã€LLMï¼‰
    Note over Chat: RAGå’ŒLLMå¯ä»¥ä½¿ç”¨æ–‡ä»¶å†…å®¹
    Chat-->>Backend: è¿”å›åˆ†æç»“æœ
    Backend-->>API: è¿”å›å›å¤
    API-->>CI: è¿”å›å›å¤
    CI-->>U: æ˜¾ç¤ºåˆ†æç»“æœ
```

### 3.5 æ–‡ä»¶ä½¿ç”¨åœºæ™¯æµç¨‹å›¾

```mermaid
graph TD
    A[ç”¨æˆ·ä¸Šä¼ æ–‡ä»¶] --> B[æ–‡ä»¶ä¿å­˜åˆ° data/uploads/]
    B --> C[è¿”å›æ–‡ä»¶è·¯å¾„ relative_path]
    C --> D[ä¿å­˜åˆ°store.sessionFiles]
    D --> E[ç”¨æˆ·åœ¨èŠå¤©ä¸­è¾“å…¥]
    E --> F{è¾“å…¥ä¸­æ˜¯å¦åŒ…å«æ–‡ä»¶è·¯å¾„?}
    F -->|æ˜¯| G[åç«¯æ£€æµ‹æ–‡ä»¶è·¯å¾„]
    F -->|å¦| H[æ­£å¸¸èŠå¤©æµç¨‹]
    G --> I[è¯»å–æ–‡ä»¶å†…å®¹]
    I --> J{æ–‡ä»¶ç±»å‹?}
    J -->|.txt/.md/.json| K[ç›´æ¥è¯»å–æ–‡æœ¬]
    J -->|.docx| L[è§£æXMLæå–æ–‡æœ¬]
    J -->|å…¶ä»–| M[è§£æå¤±è´¥ï¼Œè·³è¿‡]
    K --> N[é™„åŠ æ–‡ä»¶å†…å®¹åˆ°user_input]
    L --> N
    M --> H
    N --> O[RAGæ£€ç´¢ç›¸å…³æ—¥å¿—]
    O --> P[LLMåˆ†ææ–‡ä»¶å†…å®¹]
    P --> Q[è¿”å›åˆ†æç»“æœ]
    H --> Q
    
    style A fill:#e1f5ff
    style G fill:#fff4e1
    style N fill:#ffe1f5
    style P fill:#e1ffe1
    style Q fill:#f5e1ff
```

---

## å››ã€å®Œæ•´å·¥ä½œæµç¨‹

### 4.1 æ¨¡å‹åˆ‡æ¢å®Œæ•´æµç¨‹

```mermaid
graph TB
    A[ç”¨æˆ·æ‰“å¼€è®¾ç½®ç•Œé¢] --> B[åŠ è½½å¯ç”¨æ¨¡å‹åˆ—è¡¨]
    B --> C[æ˜¾ç¤ºå½“å‰æ¨¡å‹]
    C --> D[ç”¨æˆ·é€‰æ‹©æ–°æ¨¡å‹]
    D --> E[ç‚¹å‡»åˆ‡æ¢æŒ‰é’®]
    E --> F[è°ƒç”¨APIåˆ‡æ¢æ¨¡å‹]
    F --> G{åˆ‡æ¢æˆåŠŸ?}
    G -->|æ˜¯| H[æ›´æ–°storeçŠ¶æ€]
    G -->|å¦| I[æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯]
    H --> J[é‡ç½®æ—¥å¿—ç³»ç»Ÿ]
    J --> K[æ¸…é™¤æ—§å®ä¾‹]
    K --> L[æ–°é…ç½®ç”Ÿæ•ˆ]
    L --> M[æ˜¾ç¤ºåˆ‡æ¢æˆåŠŸ]
    I --> C
    M --> N[ä¸‹æ¬¡è°ƒç”¨æ—¶ä½¿ç”¨æ–°æ¨¡å‹]
    
    style A fill:#e1f5ff
    style F fill:#fff4e1
    style J fill:#ffe1f5
    style L fill:#e1ffe1
    style N fill:#f5e1ff
```

### 4.2 æ–‡ä»¶ä¸Šä¼ å®Œæ•´æµç¨‹

```mermaid
graph TB
    A[ç”¨æˆ·é€‰æ‹©æ–‡ä»¶] --> B[éªŒè¯æ–‡ä»¶å¤§å°]
    B --> C{æ–‡ä»¶å¤§å°åˆæ³•?}
    C -->|å¦| D[æ˜¾ç¤ºé”™è¯¯ï¼šæ–‡ä»¶è¿‡å¤§]
    C -->|æ˜¯| E[åˆ›å»ºFormData]
    E --> F[æ˜¾ç¤ºä¸Šä¼ è¿›åº¦]
    F --> G[è°ƒç”¨APIä¸Šä¼ ]
    G --> H{ä¸Šä¼ æˆåŠŸ?}
    H -->|å¦| I[æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯]
    H -->|æ˜¯| J[ç”ŸæˆUUIDæ–‡ä»¶å]
    J --> K[ä¿å­˜æ–‡ä»¶åˆ°data/uploads/]
    K --> L[è¿”å›æ–‡ä»¶å…ƒæ•°æ®]
    L --> M[ä¿å­˜åˆ°store]
    M --> N[æ˜¾ç¤ºä¸Šä¼ æˆåŠŸ]
    N --> O[ç”¨æˆ·åœ¨èŠå¤©ä¸­å¼•ç”¨æ–‡ä»¶]
    O --> P[åç«¯æ£€æµ‹æ–‡ä»¶è·¯å¾„]
    P --> Q[è¯»å–æ–‡ä»¶å†…å®¹]
    Q --> R[é™„åŠ åˆ°user_input]
    R --> S[RAGå’ŒLLMå¤„ç†]
    S --> T[è¿”å›åˆ†æç»“æœ]
    
    style A fill:#e1f5ff
    style G fill:#fff4e1
    style K fill:#ffe1f5
    style R fill:#e1ffe1
    style S fill:#f5e1ff
```

---

## äº”ã€ä»£ç æ–‡ä»¶ä½ç½®

### 5.1 æ¨¡å‹åˆ‡æ¢åŠŸèƒ½

**åç«¯ä»£ç **ï¼š
1. **æ¨¡å‹é…ç½®ç®¡ç†**ï¼š`django_backend/model_config.py`
   - `AVAILABLE_CONFIGS`ï¼šå¯ç”¨æ¨¡å‹é…ç½®å­—å…¸
   - `get_available_configs()`ï¼šè·å–æ¨¡å‹åˆ—è¡¨
   - `get_current_config_name()`ï¼šè·å–å½“å‰æ¨¡å‹
   - `set_current_config()`ï¼šåˆ‡æ¢æ¨¡å‹é…ç½®

2. **APIæ¥å£**ï¼š`django_backend/deepseek_api/api.py`
   - `list_models()`ï¼šè·å–æ¨¡å‹åˆ—è¡¨æ¥å£
   - `switch_model()`ï¼šåˆ‡æ¢æ¨¡å‹æ¥å£

3. **æœåŠ¡å±‚**ï¼š`django_backend/deepseek_api/services.py`
   - `reset_log_system()`ï¼šé‡ç½®æ—¥å¿—ç³»ç»Ÿ

4. **æ•°æ®æ¨¡å‹**ï¼š`django_backend/deepseek_api/schemas.py`
   - `ModelInfo`ï¼šæ¨¡å‹ä¿¡æ¯æ¨¡å‹
   - `ModelsOut`ï¼šæ¨¡å‹åˆ—è¡¨å“åº”æ¨¡å‹
   - `ModelSwitchIn`ï¼šæ¨¡å‹åˆ‡æ¢è¯·æ±‚æ¨¡å‹

**å‰ç«¯ä»£ç **ï¼š
1. **APIè°ƒç”¨**ï¼š`vue_frontend/src/api.js`
   - `getModels()`ï¼šè·å–æ¨¡å‹åˆ—è¡¨
   - `switchModel()`ï¼šåˆ‡æ¢æ¨¡å‹

2. **çŠ¶æ€ç®¡ç†**ï¼š`vue_frontend/src/store.js`
   - `setModelOptions()`ï¼šä¿å­˜æ¨¡å‹åˆ—è¡¨
   - `setCurrentModel()`ï¼šæ›´æ–°å½“å‰æ¨¡å‹

3. **UIç»„ä»¶**ï¼š
   - `vue_frontend/src/components/Settings.vue`ï¼šè®¾ç½®ç•Œé¢
   - `vue_frontend/src/components/ChatInput.vue`ï¼šè¾“å…¥ç»„ä»¶ï¼ˆæ¨¡å‹é€‰æ‹©ï¼‰
   - `vue_frontend/src/views/Chat.vue`ï¼šèŠå¤©ç•Œé¢ï¼ˆåŠ è½½æ¨¡å‹åˆ—è¡¨ï¼‰

### 5.2 æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½

**åç«¯ä»£ç **ï¼š
1. **APIæ¥å£**ï¼š`django_backend/deepseek_api/api.py`
   - `upload_file()`ï¼šæ–‡ä»¶ä¸Šä¼ æ¥å£
   - `chat()`ï¼šèŠå¤©æ¥å£ï¼ˆæ–‡ä»¶å†…å®¹è§£æï¼‰

2. **æ•°æ®æ¨¡å‹**ï¼š`django_backend/deepseek_api/schemas.py`
   - `FileUploadOut`ï¼šæ–‡ä»¶ä¸Šä¼ å“åº”æ¨¡å‹

**å‰ç«¯ä»£ç **ï¼š
1. **APIè°ƒç”¨**ï¼š`vue_frontend/src/api.js`
   - `uploadFile()`ï¼šä¸Šä¼ æ–‡ä»¶

2. **çŠ¶æ€ç®¡ç†**ï¼š`vue_frontend/src/store.js`
   - `addUploadedFile()`ï¼šæ·»åŠ ä¸Šä¼ æ–‡ä»¶
   - `getSessionFiles()`ï¼šè·å–ä¼šè¯æ–‡ä»¶åˆ—è¡¨
   - `clearSessionFiles()`ï¼šæ¸…ç©ºä¼šè¯æ–‡ä»¶

3. **UIç»„ä»¶**ï¼š
   - `vue_frontend/src/components/ChatInput.vue`ï¼šè¾“å…¥ç»„ä»¶ï¼ˆæ–‡ä»¶ä¸Šä¼ ï¼‰

---

## å…­ã€å…³é”®æŠ€æœ¯ç‚¹

### 6.1 æ¨¡å‹åˆ‡æ¢å…³é”®æŠ€æœ¯

1. **é…ç½®ç®¡ç†**ï¼š
   - ä½¿ç”¨å…¨å±€å­—å…¸ `CURRENT_CONFIG` å­˜å‚¨å½“å‰é…ç½®
   - åˆ‡æ¢æ—¶ä½¿ç”¨ `clear()` å’Œ `update()` ä¿æŒå¼•ç”¨ä¸å˜
   - å…¶ä»–æ¨¡å—å¼•ç”¨ `CURRENT_CONFIG` æ—¶è‡ªåŠ¨è·å¾—æ–°é…ç½®

2. **å®ä¾‹é‡ç½®**ï¼š
   - `TopKLogSystem` æ˜¯å•ä¾‹æ¨¡å¼
   - åˆ‡æ¢é…ç½®åéœ€è¦æ¸…é™¤æ—§å®ä¾‹
   - ä¸‹æ¬¡è°ƒç”¨ `get_log_system()` æ—¶ç”¨æ–°é…ç½®é‡æ–°åˆå§‹åŒ–

3. **çº¿ç¨‹å®‰å…¨**ï¼š
   - ä½¿ç”¨çº¿ç¨‹é” `_log_system_lock` ç¡®ä¿çº¿ç¨‹å®‰å…¨
   - é¿å…å¤šçº¿ç¨‹åŒæ—¶ä¿®æ”¹é…ç½®

### 6.2 æ–‡ä»¶ä¸Šä¼ å…³é”®æŠ€æœ¯

1. **æ–‡ä»¶å­˜å‚¨**ï¼š
   - ä½¿ç”¨UUIDç”Ÿæˆå”¯ä¸€æ–‡ä»¶åï¼Œé¿å…æ–‡ä»¶åå†²çª
   - æ–‡ä»¶ä¿å­˜åœ¨ `data/uploads/` ç›®å½•
   - è¿”å›ç›¸å¯¹è·¯å¾„ï¼Œä¾¿äºåç»­å¼•ç”¨

2. **æ–‡ä»¶è§£æ**ï¼š
   - æ–‡æœ¬æ–‡ä»¶ï¼šç›´æ¥è¯»å–ï¼ˆUTF-8ç¼–ç ï¼‰
   - Wordæ–‡æ¡£ï¼šè§£æXMLæå–æ–‡æœ¬ï¼ˆæ— éœ€å¤–éƒ¨ä¾èµ–ï¼‰
   - å…¶ä»–æ ¼å¼ï¼šä¸Šä¼ æˆåŠŸï¼Œä½†å†…å®¹è§£æå¯èƒ½å¤±è´¥

3. **æ–‡ä»¶å¼•ç”¨**ï¼š
   - ç”¨æˆ·åœ¨è¾“å…¥ä¸­å¼•ç”¨æ–‡ä»¶è·¯å¾„ï¼ˆ`data/uploads/xxx`ï¼‰
   - åç«¯è‡ªåŠ¨æ£€æµ‹å¹¶è¯»å–æ–‡ä»¶å†…å®¹
   - æ–‡ä»¶å†…å®¹é™„åŠ åˆ°ç”¨æˆ·è¾“å…¥ï¼Œä¾›RAGå’ŒLLMä½¿ç”¨

4. **çŠ¶æ€ç®¡ç†**ï¼š
   - æ–‡ä»¶ä¿¡æ¯ä¿å­˜åœ¨ `store.sessionFiles`
   - æ¯ä¸ªä¼šè¯ç»´æŠ¤ç‹¬ç«‹çš„æ–‡ä»¶åˆ—è¡¨
   - æ–‡ä»¶ä¿¡æ¯æŒä¹…åŒ–åˆ° `localStorage`

---

## ä¸ƒã€ä½¿ç”¨ç¤ºä¾‹

### 7.1 æ¨¡å‹åˆ‡æ¢ç¤ºä¾‹

**å‰ç«¯è°ƒç”¨**ï¼š
```javascript
// è·å–æ¨¡å‹åˆ—è¡¨
const response = await api.getModels();
const models = response.data.options;  // å¯ç”¨æ¨¡å‹åˆ—è¡¨
const current = response.data.current;  // å½“å‰æ¨¡å‹

// åˆ‡æ¢æ¨¡å‹
const response = await api.switchModel('deepseek_api');
const newCurrent = response.data.current;  // æ–°å½“å‰æ¨¡å‹
```

**åç«¯å¤„ç†**ï¼š
```python
# åˆ‡æ¢é…ç½®
set_current_config('deepseek_api')

# é‡ç½®æ—¥å¿—ç³»ç»Ÿ
reset_log_system()

# è¿”å›æ›´æ–°åçš„é…ç½®
return {
    "current": "deepseek_api",
    "options": [...]
}
```

### 7.2 æ–‡ä»¶ä¸Šä¼ ç¤ºä¾‹

**å‰ç«¯ä¸Šä¼ **ï¼š
```javascript
// åˆ›å»ºFormData
const formData = new FormData();
formData.append("file", file);

// ä¸Šä¼ æ–‡ä»¶
const response = await api.uploadFile(formData);
const filePath = response.data.relative_path;  // data/uploads/xxx.txt

// ä¿å­˜åˆ°store
store.addUploadedFile(sessionId, {
    name: response.data.original_filename,
    path: response.data.relative_path,
});
```

**åç«¯å¤„ç†**ï¼š
```python
# ä¿å­˜æ–‡ä»¶
destination_path = UPLOAD_ROOT / stored_filename
with destination_path.open("wb+") as destination:
    for chunk in file.chunks():
        destination.write(chunk)

# è¿”å›æ–‡ä»¶å…ƒæ•°æ®
return {
    "original_filename": "example.txt",
    "stored_filename": "a1b2c3d4e5f6.txt",
    "size": 1024,
    "relative_path": "data/uploads/a1b2c3d4e5f6.txt"
}
```

**ä½¿ç”¨æ–‡ä»¶**ï¼š
```python
# ç”¨æˆ·è¾“å…¥ï¼š"åˆ†æè¿™ä¸ªæ–‡ä»¶ data/uploads/xxx.txt"
# åç«¯æ£€æµ‹åˆ°æ–‡ä»¶è·¯å¾„ï¼Œè¯»å–æ–‡ä»¶å†…å®¹
file_content = read_file("data/uploads/xxx.txt")

# é™„åŠ åˆ°ç”¨æˆ·è¾“å…¥
user_input += f"\n\n[é™„ä»¶: data/uploads/xxx.txt å†…å®¹å¼€å§‹]\n{file_content}\n[é™„ä»¶: data/uploads/xxx.txt å†…å®¹ç»“æŸ]\n"

# RAGå’ŒLLMå¤„ç†æ—¶å¯ä»¥ä½¿ç”¨æ–‡ä»¶å†…å®¹
```

---

## å…«ã€æ€»ç»“

### 8.1 æ¨¡å‹åˆ‡æ¢åŠŸèƒ½

- **åŠŸèƒ½**ï¼šæ”¯æŒå¤šç§æ¨¡å‹é…ç½®åˆ‡æ¢ï¼ˆAPIæ¨¡å¼ã€æœ¬åœ°Ollamaæ¨¡å¼ï¼‰
- **ç‰¹ç‚¹**ï¼šåˆ‡æ¢åè‡ªåŠ¨é‡ç½®æ—¥å¿—ç³»ç»Ÿï¼Œç¡®ä¿æ–°é…ç½®ç”Ÿæ•ˆ
- **å®ç°**ï¼šé…ç½®ç®¡ç† + å®ä¾‹é‡ç½® + çŠ¶æ€åŒæ­¥

### 8.2 æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½

- **åŠŸèƒ½**ï¼šæ”¯æŒæ–‡ä»¶ä¸Šä¼ ï¼Œå¹¶åœ¨èŠå¤©ä¸­å¼•ç”¨æ–‡ä»¶å†…å®¹
- **ç‰¹ç‚¹**ï¼šè‡ªåŠ¨è§£ææ–‡ä»¶å†…å®¹ï¼Œä¾›RAGå’ŒLLMä½¿ç”¨
- **å®ç°**ï¼šæ–‡ä»¶å­˜å‚¨ + å†…å®¹è§£æ + çŠ¶æ€ç®¡ç†

### 8.3 æŠ€æœ¯äº®ç‚¹

1. **é…ç½®ç®¡ç†**ï¼šä½¿ç”¨å…¨å±€å­—å…¸å’Œå¼•ç”¨æœºåˆ¶ï¼Œå®ç°é…ç½®æ— ç¼åˆ‡æ¢
2. **æ–‡ä»¶è§£æ**ï¼šæ”¯æŒå¤šç§æ–‡ä»¶æ ¼å¼ï¼ŒåŒ…æ‹¬Wordæ–‡æ¡£çš„XMLè§£æ
3. **çŠ¶æ€åŒæ­¥**ï¼šå‰åç«¯çŠ¶æ€åŒæ­¥ï¼Œç¡®ä¿ç”¨æˆ·ä½“éªŒä¸€è‡´
4. **é”™è¯¯å¤„ç†**ï¼šå®Œå–„çš„é”™è¯¯å¤„ç†å’Œç”¨æˆ·æç¤º

---

**æ–‡æ¡£ç‰ˆæœ¬**ï¼š1.0  
**æœ€åæ›´æ–°**ï¼š2025å¹´  
**ä½œè€…**ï¼šç³»ç»Ÿå¼€å‘å›¢é˜Ÿ

